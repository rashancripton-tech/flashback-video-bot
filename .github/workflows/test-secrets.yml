name: Testar Secrets

on:
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - name: Verificar Secrets
        run: |
          echo "=== TESTANDO SECRETS ==="
          if [ -n "${{ secrets.TELEGRAM_BOT_TOKEN }}" ]; then
            echo "✅ TELEGRAM_BOT_TOKEN existe"
          else
            echo "❌ TELEGRAM_BOT_TOKEN NAO EXISTE"
          fi
          
          if [ -n "${{ secrets.TELEGRAM_CHAT_ID }}" ]; then
            echo "✅ TELEGRAM_CHAT_ID existe"
          else
            echo "❌ TELEGRAM_CHAT_ID NAO EXISTE"
          fi
          
          if [ -n "${{ secrets.TELEGRAMBOTTOKEN }}" ]; then
            echo "✅ TELEGRAMBOTTOKEN (sem underscore) existe"
          else
            echo "❌ TELEGRAMBOTTOKEN NAO EXISTE"
          fi
          
          if [ -n "${{ secrets.TELEGRAMCHATID }}" ]; then
            echo "✅ TELEGRAMCHATID (sem underscore) existe"
          else
            echo "❌ TELEGRAMCHATID NAO EXISTE"
          fi

      - name: Testar Telegram API
        env:
          TOKEN1: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          CHAT1: ${{ secrets.TELEGRAM_CHAT_ID }}
          TOKEN2: ${{ secrets.TELEGRAMBOTTOKEN }}
          CHAT2: ${{ secrets.TELEGRAMCHATID }}
        run: |
          echo "=== TESTANDO CONEXAO COM TELEGRAM ==="
          
          if [ -n "$TOKEN1" ] && [ -n "$CHAT1" ]; then
            echo "Tentando com TELEGRAM_BOT_TOKEN e TELEGRAM_CHAT_ID..."
            curl -s "https://api.telegram.org/bot${TOKEN1}/sendMessage?chat_id=${CHAT1}&text=Teste com underscore" || echo "Falhou"
          fi
          
          if [ -n "$TOKEN2" ] && [ -n "$CHAT2" ]; then
            echo "Tentando com TELEGRAMBOTTOKEN e TELEGRAMCHATID..."
            curl -s "https://api.telegram.org/bot${TOKEN2}/sendMessage?chat_id=${CHAT2}&text=Teste sem underscore" || echo "Falhou"
          fi
